---
title: "Seattle Weather"
execute: 
  echo: false
  daemon: false
---

TODO: why aren't we seeing the grayed out counter selection
TODO: implement bar chart

An interactive view of Seattle's weather, including maximum temperature, amount of precipitation, and type of weather. By dragging on the scatter plot, you can see the proportion of days in that range that have sun, fog, drizzle, rain, or snow.

Based on a [Vega-Lite/Altair example](https://vega.github.io/vega-lite/examples/interactive_seattle_weather.html) by Jake Vanderplas.

```{python}
import inspect_viz as vz
import inspect_viz.transform as tx

# data
weather = vz.Data("seattle-weather.parquet")

# conditions domain/colors
conditions = ["sun", "fog", "drizzle", "rain", "snow"]
conditions_colors = ["#e7ba52", "#a7a7a7", "#aec7e8", "#1f77b4", "#9467bd"]

# scatterplot x-range selection
range = vz.Selection("intersect")

# bar chart / legend click selection
click = vz.Selection("single")
```

```{python}
vz.plot(
    [
        vz.dot(
            data=weather,
            filter_by=click,
            x=tx.date_month_day("date"),
            y="temp_max",
            fill="weather",
            fill_opacity=0.7,
        ),
        vz.interval_x(selection=range, brush=vz.Brush(fill="none", stroke="#888")),
        vz.highlight(by=range, fill="#ccc", fill_opacity=0.2)
    ],
    legend=vz.legend("color", selection=click, columns=1),
    xy_domain=vz.Fixed,
    x_tick_format="%b",
    color_domain=conditions,
    color_range=conditions_colors,
    r_domain=vz.Fixed,
    r_range=[2, 10],
    width=680,
    height=300,
)
```

```{python}

```
